shadow$provide[85]=function(Nc,Vb,pc,wb){(function(p,ma){"function"===typeof define&&define.amd?define([],ma):"object"===typeof pc&&pc.exports?pc.exports=ma():p.parinfer=ma()})(this,function(){function p(l){return"number"===typeof l&&isFinite(l)&&Math.floor(l)===l}function ma(l){l=l||{};return{cursorX:l.cursorX,cursorLine:l.cursorLine,prevCursorX:l.prevCursorX,prevCursorLine:l.prevCursorLine,selectionStartLine:l.selectionStartLine,changes:l.changes,partialResult:l.partialResult,forceBalance:l.forceBalance,
returnParens:l.returnParens}}function Ma(){return{lineNo:-999,startX:-999,endX:-999,openers:[],clamped:{startX:-999,endX:-999,openers:[]}}}function y(l,q){var w={lineNo:l.lineNo,x:l.x,inputLineNo:l.inputLineNo,inputX:l.inputX};return l.errorPosCache[q]=w}function O(l,q){var w=l.errorPosCache[q],z=l.partialResult?"lineNo":"inputLineNo",G=l.partialResult?"x":"inputX",H={parinferError:!0,name:q,message:f[q],lineNo:w?w[z]:l[z],x:w?w[G]:l[G]},R=ua(l.parenStack,0);if("unmatched-close-paren"===q){if((w=
l.errorPosCache["unmatched-open-paren"])||R)H.extra={name:"unmatched-open-paren",lineNo:w?w[z]:R[z],x:w?w[G]:R[G]}}else"unclosed-paren"===q&&(H.lineNo=R[z],H.x=R[G]);return H}function X(l,q,w,z,G){var H=l.lines[q];H=H.substring(0,w)+G+H.substring(z);l.lines[q]=H;G=G.length-(z-w);0!==G&&l.cursorLine===q&&-999!==l.cursorX&&(l.cursorX===w&&l.cursorX===z?0===l.cursorX:l.cursorX>=z)&&(l.cursorX+=G)}function la(l){l.x=0;l.lineNo++;l.indentX=-999;l.commentX=-999;l.indentDelta=0;delete l.errorPosCache["unmatched-close-paren"];
delete l.errorPosCache["unmatched-open-paren"];delete l.errorPosCache["leading-close-paren"];l.trackingArgTabStop=null;l.trackingIndent=!l.isInStr}function ua(l,q){var w=l.length-1;return q>w?null:l[w-q]}function Ea(l){return"}"===l||")"===l||"]"===l}function ka(l,q){return 0===l.length?!1:ua(l,0).ch===d[q]}function P(l){var q=l.ch;return!l.isEscaped&&(" "===q||"  "===q)}function ca(l,q,w,z){return q===z&&-999!==w&&-999!==l&&l>w}function va(l,q,w){return ca(q,w,l.commentX,l.lineNo)}function ra(l,
q,w){l.parenTrail.lineNo=q;l.parenTrail.startX=w;l.parenTrail.endX=w;l.parenTrail.openers=[];l.parenTrail.clamped.startX=-999;l.parenTrail.clamped.endX=-999;l.parenTrail.clamped.openers=[]}function Y(l,q){var w;for(w=0;w<l.parenStack.length;w++){var z=ua(l.parenStack,w),G=z.x<q,H=z.x-z.indentDelta<q-l.indentDelta,R=!1;H&&G?R=!0:H||G?H&&!G?R=0===l.indentDelta?!0:!1:!H&&G&&((G=ua(l.parenStack,w+1))&&G.indentDelta<=z.indentDelta?R=q+G.indentDelta>z.x?!0:!1:G&&G.indentDelta>z.indentDelta?R=!0:l.indentDelta>
z.indentDelta&&(R=!0),R&&(z.indentDelta=0)):R=!1;if(R)break}return w}function qa(l,q){if(q){var w=ua(l.parenStack,0);w?w.maxChildIndent=q.x:l.maxIndent=q.x}}function ya(l){var q=l.parenTrail,w=q.clamped.openers.concat(q.openers);if(0<w.length&&(q={lineNo:q.lineNo,startX:-999!==q.clamped.startX?q.clamped.startX:q.startX,endX:0===q.openers.length?q.clamped.endX:q.endX},l.parenTrails.push(q),l.returnParens))for(l=0;l<w.length;l++)w[l].closer.trail=q}function ia(l,q){var w=l.x,z=w+q,G,H="";for(G=0;G<
z;G++)H+=" ";X(l,l.lineNo,0,w,H);l.x=z;l.indentX=z;l.indentDelta+=q}function ea(l){l.indentX=l.x;l.trackingIndent=!1;if(l.quoteDanger)throw O(l,"quote-danger");if("INDENT_MODE"===l.mode){var q="",w=Y(l,l.x),z;for(z=0;z<w;z++){var G=l.parenStack.pop();l.parenTrail.openers.push(G);var H=d[G.ch];q+=H;if(l.returnParens){var R=l.parenTrail.startX+z;G.closer.lineNo=l.parenTrail.lineNo;G.closer.x=R;G.closer.ch=H}}-999!==l.parenTrail.lineNo&&(X(l,l.parenTrail.lineNo,l.parenTrail.startX,l.parenTrail.endX,
q),l.parenTrail.endX=l.parenTrail.startX+q.length,ya(l));(q=ua(l.parenStack,0))&&q.indentDelta!==l.indentDelta&&ia(l,q.indentDelta)}else if("PAREN_MODE"===l.mode){H=q=l.x;w=0;z=l.maxIndent;if(G=ua(l.parenStack,0))w=G.x+1,z=G.maxChildIndent,G.indentDelta!==l.indentDelta&&(H+=G.indentDelta);-999!==w&&(H=Math.max(w,H));-999!==z&&(H=Math.min(z,H));H!==q&&ia(l,H-q)}}function Ha(l,q){l={ch:q.ch,x:q.x,lineNo:q.lineNo};null!=q.argX&&(l.argX=q.argX);return l}function aa(l,q){l.ch=q;l.skipChar=!1;if(l.changes&&
(l.smart||"PAREN_MODE"===l.mode)){var w=l.changes[l.inputLineNo];w&&(w=w[l.inputX])&&(l.indentDelta+=w.newEndX-w.oldEndX)}if(l.trackingIndent)if(Ea(l.ch)){if("INDENT_MODE"===l.mode){if(!l.forceBalance){if(l.smart)throw{leadingCloseParen:!0};l.errorPosCache["leading-close-paren"]||y(l,"leading-close-paren")}l.skipChar=!0}if("PAREN_MODE"===l.mode)if(ka(l.parenStack,l.ch)){w=l.cursorX;var z=l.x;if(l.cursorLine===l.lineNo&&-999!==z&&-999!==w&&w<=z)ra(l,l.lineNo,l.x),ea(l);else{w=l;z=w.parenStack.pop();
var G=d[z.ch];if(w.returnParens){var H=w.parenTrail.endX;z.closer.lineNo=w.parenTrail.lineNo;z.closer.x=H;z.closer.ch=G}qa(w,z);H=w.parenTrail.endX;X(w,w.parenTrail.lineNo,H,H,G);w.parenTrail.endX++;w.parenTrail.openers.push(z);(z=w.parenTrails[w.parenTrails.length-1])&&z.lineNo===w.parenTrail.lineNo?(z.endX=w.parenTrail.endX,w.returnParens&&(w.parenTrail.openers[w.parenTrail.openers.length-1].closer.trail=z)):ya(w);l.skipChar=!0}}else if(l.smart)l.skipChar=!0;else throw O(l,"unmatched-close-paren");
}else if(";"===l.ch){w=l.parenTrail.openers.length;if("PAREN_MODE"===l.mode)for(z=0;z<w;z++)l.parenStack.push(ua(l.parenTrail.openers,z));z=Y(l,l.x);(z=ua(l.parenStack,z))&&z.indentDelta!==l.indentDelta&&ia(l,z.indentDelta);if("PAREN_MODE"===l.mode)for(z=0;z<w;z++)l.parenStack.pop();l.trackingIndent=!1}else"\n"!==l.ch&&" "!==l.ch&&"\t"!==l.ch&&ea(l);if(l.skipChar)l.ch="";else{w=l.ch;l.isEscaped=!1;if(l.isEscaping){if(l.isEscaping=!1,l.isEscaped=!0,"\n"===l.ch){if(l.isInCode)throw O(l,"eol-backslash");
w=l;w.isInComment=!1;w.ch=""}}else if("{"===w||"("===w||"["===w)l.isInCode&&(w={inputLineNo:l.inputLineNo,inputX:l.inputX,lineNo:l.lineNo,x:l.x,ch:l.ch,indentDelta:l.indentDelta,maxChildIndent:-999},l.returnParens&&(w.children=[],w.closer={lineNo:-999,x:-999,ch:""},z=(z=ua(l.parenStack,0))?z.children:l.parens,z.push(w)),l.parenStack.push(w),l.trackingArgTabStop="space");else if(Ea(w)){if(l.isInCode)if(ka(l.parenStack,l.ch)){w=l;z=ua(w.parenStack,0);w.returnParens&&(G=w.x,H=w.ch,z.closer.lineNo=w.lineNo,
z.closer.x=G,z.closer.ch=H);w.parenTrail.endX=w.x+1;w.parenTrail.openers.push(z);if(z="INDENT_MODE"===w.mode&&w.smart){z=ua(w.parenStack,0);G=(G=ua(w.parenStack,1))?G.x+1:0;H=z.x;var R=w.cursorLine===z.lineNo&&G<=w.cursorX&&w.cursorX<=H;if(!w.changes&&-999!==w.prevCursorLine&&w.prevCursorLine===z.lineNo&&G<=w.prevCursorX&&w.prevCursorX<=H&&!R)throw{releaseCursorHold:!0};z=R}z&&(z=w.parenTrail.startX,G=w.parenTrail.endX,H=w.parenTrail.openers,ra(w,w.lineNo,w.x+1),w.parenTrail.clamped.startX=z,w.parenTrail.clamped.endX=
G,w.parenTrail.clamped.openers=H);w.parenStack.pop();w.trackingArgTabStop=null}else{w=l;if("PAREN_MODE"===w.mode){if(z=w.parenTrail,z=z.lineNo===w.lineNo&&z.startX===w.indentX,!w.smart||!z)throw O(w,"unmatched-close-paren");}else"INDENT_MODE"===w.mode&&!w.errorPosCache["unmatched-close-paren"]&&(y(w,"unmatched-close-paren"),z=ua(w.parenStack,0))&&(G=y(w,"unmatched-open-paren"),G.inputLineNo=z.inputLineNo,G.inputX=z.inputX);w.ch=""}}else'"'===w?l.isInStr?l.isInStr=!1:l.isInComment?(l.quoteDanger=!l.quoteDanger,
l.quoteDanger&&y(l,"quote-danger")):(l.isInStr=!0,y(l,"unclosed-quote")):";"===w?l.isInCode&&(l.isInComment=!0,l.commentX=l.x,l.trackingArgTabStop=null):"\\"===w?l.isEscaping=!0:"\t"===w?l.isInCode&&(l.ch="  "):"\n"===w&&(w=l,w.isInComment=!1,w.ch="");w=l.ch;l.isInCode=!l.isInComment&&!l.isInStr;z=l.ch;G=Ea(z)&&!l.isEscaped;l.isInCode&&!P(l)&&""!==z&&!G&&ra(l,l.lineNo,l.x+w.length);if(w=l.trackingArgTabStop)"space"===w?l.isInCode&&P(l)&&(l.trackingArgTabStop="arg"):"arg"!==w||P(l)||(ua(l.parenStack,
0).argX=l.x,l.trackingArgTabStop=null)}w=l.ch;q!==w&&(X(l,l.lineNo,l.x,l.x+q.length,w),l.indentDelta-=q.length-w.length);l.x+=w.length}function Ba(l,q,w,z){w={mode:w,smart:z,origText:l,origCursorX:-999,origCursorLine:-999,inputLines:l.split(Ya),inputLineNo:-1,inputX:-1,lines:[],lineNo:-1,ch:"",x:0,indentX:-999,parenStack:[],tabStops:[],parenTrail:Ma(),parenTrails:[],returnParens:!1,parens:[],cursorX:-999,cursorLine:-999,prevCursorX:-999,prevCursorLine:-999,selectionStartLine:-999,changes:null,isInCode:!0,
isEscaping:!1,isEscaped:!1,isInStr:!1,isInComment:!1,commentX:-999,quoteDanger:!1,trackingIndent:!1,skipChar:!1,success:!1,partialResult:!1,forceBalance:!1,maxIndent:-999,indentDelta:0,trackingArgTabStop:null,error:{name:null,message:null,lineNo:null,x:null,extra:{name:null,lineNo:null,x:null}},errorPosCache:{}};if(q){p(q.cursorX)&&(w.cursorX=q.cursorX,w.origCursorX=q.cursorX);p(q.cursorLine)&&(w.cursorLine=q.cursorLine,w.origCursorLine=q.cursorLine);p(q.prevCursorX)&&(w.prevCursorX=q.prevCursorX);
p(q.prevCursorLine)&&(w.prevCursorLine=q.prevCursorLine);p(q.selectionStartLine)&&(w.selectionStartLine=q.selectionStartLine);if(Array.isArray(q.changes)){var G=q.changes;if(0===G.length)G=null;else{var H={},R,ha;for(ha=0;ha<G.length;ha++){if(R=G[ha]){var Ja=R.newText.split(Ya);var D=R.oldText.split(Ya);var Q=(1===Ja.length?R.x:0)+Ja[Ja.length-1].length;Ja=R.lineNo+(Ja.length-1);D={x:R.x,lineNo:R.lineNo,oldText:R.oldText,newText:R.newText,oldEndX:(1===D.length?R.x:0)+D[D.length-1].length,newEndX:Q,
newEndLineNo:Ja,lookupLineNo:Ja,lookupX:Q}}else D=void 0;(R=H[D.lookupLineNo])||(R=H[D.lookupLineNo]={});R[D.lookupX]=D}G=H}w.changes=G}"boolean"===typeof q.partialResult&&(w.partialResult=q.partialResult);"boolean"===typeof q.forceBalance&&(w.forceBalance=q.forceBalance);"boolean"===typeof q.returnParens&&(w.returnParens=q.returnParens)}try{var oa;for(oa=0;oa<w.inputLines.length;oa++){w.inputLineNo=oa;G=void 0;H=w;ha=oa;la(H);H.lines.push(H.inputLines[ha]);R=void 0;D=H;if((-999!==D.selectionStartLine?
D.selectionStartLine:D.cursorLine)===D.lineNo){for(R=0;R<D.parenStack.length;R++)D.tabStops.push(Ha(D,D.parenStack[R]));if("PAREN_MODE"===D.mode)for(R=D.parenTrail.openers.length-1;0<=R;R--)D.tabStops.push(Ha(D,D.parenTrail.openers[R]));for(R=1;R<D.tabStops.length;R++){var Fa=D.tabStops[R].x,Ga=D.tabStops[R-1].argX;null!=Ga&&Ga>=Fa&&delete D.tabStops[R-1].argX}}for(G=0;G<H.inputLines[ha].length;G++)H.inputX=G,aa(H,H.inputLines[ha][G]);aa(H,"\n");if(!H.forceBalance){var xb=H.errorPosCache["unmatched-close-paren"];
if(xb&&xb.x<H.parenTrail.startX)throw O(H,"unmatched-close-paren");if(H.errorPosCache["leading-close-paren"]&&H.parenTrail.lineNo===H.lineNo)throw O(H,"leading-close-paren");}if(H.lineNo===H.parenTrail.lineNo)if(G=H,G.isInStr)G.parenTrail=Ma();else if("INDENT_MODE"===G.mode){H=void 0;ha=G;var Hb=ha.parenTrail.startX,Kb=ha.parenTrail.endX,Cb;R=ha;var ib=ha.cursorX,Ib=ha.cursorLine;if(Cb=ca(ib,Ib,R.parenTrail.startX,R.lineNo)&&!va(R,ib,Ib)){var Oa=Math.max(Hb,ha.cursorX),Ua=Math.max(Kb,ha.cursorX),
Pa=ha.lines[ha.lineNo];R=0;for(H=Hb;H<Oa;H++)Ea(Pa[H])&&R++;var ja=ha.parenTrail.openers;ha.parenTrail.openers=ja.slice(R);ha.parenTrail.startX=Oa;ha.parenTrail.endX=Ua;ha.parenTrail.clamped.openers=ja.slice(0,R);ha.parenTrail.clamped.startX=Hb;ha.parenTrail.clamped.endX=Kb}if(G.parenTrail.startX!==G.parenTrail.endX)for(var Qa=G.parenTrail.openers;0!==Qa.length;)G.parenStack.push(Qa.pop())}else if("PAREN_MODE"===G.mode){qa(G,ua(G.parenTrail.openers,0));if(G.lineNo!==G.cursorLine){H=void 0;ha=G;var Za=
ha.parenTrail.startX,qb=ha.parenTrail.endX;if(Za!==qb&&ha.lineNo===ha.parenTrail.lineNo){var La=ha.lines[ha.lineNo];R="";D=0;for(H=Za;H<qb;H++)Ea(La[H])?R+=La[H]:D++;0<D&&(X(ha,ha.lineNo,Za,qb,R),ha.parenTrail.endX-=D)}}ya(G)}}if(w.quoteDanger)throw O(w,"quote-danger");if(w.isInStr)throw O(w,"unclosed-quote");if(0!==w.parenStack.length&&"PAREN_MODE"===w.mode)throw O(w,"unclosed-paren");"INDENT_MODE"===w.mode&&(la(w),ea(w));w.success=!0}catch(Na){if(Na.leadingCloseParen||Na.releaseCursorHold)return Ba(l,
q,"PAREN_MODE",z);l=Na;w.success=!1;if(l.parinferError)delete l.parinferError,w.error=l;else throw w.error.name="unhandled",w.error.message=l.stack,l;}return w}function Va(l){var q=-1!==l.origText.search("\r")?"\r\n":"\n";l.success?(q={text:l.lines.join(q),cursorX:l.cursorX,cursorLine:l.cursorLine,success:!0,tabStops:l.tabStops,parenTrails:l.parenTrails},l.returnParens&&(q.parens=l.parens)):(q={text:l.partialResult?l.lines.join(q):l.origText,cursorX:l.partialResult?l.cursorX:l.origCursorX,cursorLine:l.partialResult?
l.cursorLine:l.origCursorLine,parenTrails:l.partialResult?l.parenTrails:null,success:!1,error:l.error},l.partialResult&&l.returnParens&&(q.parens=l.parens));-999===q.cursorX&&delete q.cursorX;-999===q.cursorLine&&delete q.cursorLine;q.tabStops&&0===q.tabStops.length&&delete q.tabStops;return q}var Ya=/\r?\n/,d={"{":"}","}":"{","[":"]","]":"[","(":")",")":"("},f={"quote-danger":"Quotes must balanced inside comment blocks.","eol-backslash":"Line cannot end in a hanging backslash.","unclosed-quote":"String is missing a closing quote.",
"unclosed-paren":"Unclosed open-paren.","unmatched-close-paren":"Unmatched close-paren.","unmatched-open-paren":"Unmatched open-paren.","leading-close-paren":"Line cannot lead with a close-paren.",unhandled:"Unhandled error."};return{version:"3.12.0",indentMode:function(l,q){q=ma(q);return Va(Ba(l,q,"INDENT_MODE"))},parenMode:function(l,q){q=ma(q);return Va(Ba(l,q,"PAREN_MODE"))},smartMode:function(l,q){q=ma(q);return Va(Ba(l,q,"INDENT_MODE",null==q.selectionStartLine))}}})}
goog.provide("module$node_modules$parinfer$parinfer");
goog.global. module$node_modules$parinfer$parinfer=shadow.js.require(85, {});
